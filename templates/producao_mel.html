{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="honeycomb-bg"></div>
    <h2><i class="fas fa-jar"></i> Produção de Mel</h2>

    <form method="POST" action="{{ url_for('registrar_producao_mel') }}">
        <div class="form-group">
            <label for="quantidadeMel"><i class="fas fa-weight-hanging"></i> Quantidade Produzida (kg)</label>
            <input type="number" id="quantidadeMel" name="quantidadeMel" step="0.01" min="0" placeholder="Ex: 5.2" required>
        </div>

        <div class="form-group">
            <label for="dataMel"><i class="fas fa-calendar-alt"></i> Data da Colheita</label>
            <input type="date" id="dataMel" name="dataMel" required>
        </div>

        <div class="form-group">
            <label for="observacoesMel"><i class="fas fa-sticky-note"></i> Observações</label>
            <textarea id="observacoesMel" name="observacoesMel" placeholder="Observações sobre a produção..."></textarea>
        </div>

        <div class="btn-group">
            <button type="submit" class="btn">
                <i class="fas fa-save"></i> Registrar Produção
            </button>
            <a href="{{ url_for('monitoramento') }}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Voltar
            </a>
        </div>
    </form>

    <h3><i class="fas fa-history"></i> Minhas Produções de Mel</h3>
    <div id="registrosMel">
        {% for producao in producoes_mel %}
        <div class="registro">
            <strong><i class="fas fa-calendar"></i> Data/Hora:</strong> {{ producao.data_registro.strftime('%d/%m/%Y %H:%M') }}<br>
            <strong><i class="fas fa-user"></i> Registrado por:</strong> {{ producao.usuario.nome }}<br>
            <strong><i class="fas fa-weight-hanging"></i> Quantidade:</strong> {{ producao.quantidade }} kg<br>
            <strong><i class="fas fa-calendar-alt"></i> Data Colheita:</strong> {{ producao.data_colheita.strftime('%d/%m/%Y') }}<br>
            <strong><i class="fas fa-sticky-note"></i> Observações:</strong> {{ producao.observacoes or "(vazio)" }}<br>
            
            {% if is_admin or producao.usuario_id == session.usuario_id %}
            <form method="POST" action="{{ url_for('excluir_producao_mel', id=producao.id) }}" style="display: inline;">
                <button type="submit" onclick="return confirm('Tem certeza que deseja apagar este registro de produção?')">
                    <i class="fas fa-trash"></i> Apagar
                </button>
            </form>
            {% endif %}
        </div>
        {% else %}
        <p>Nenhuma produção de mel registrada ainda.</p>
        {% endfor %}
    </div>

    <h3><i class="fas fa-users"></i> Todas as Produções da Equipe</h3>
    <div id="todas-producoes">
        {% for producao in todas_producoes %}
        <div class="registro">
            <strong><i class="fas fa-calendar"></i> Data/Hora:</strong> {{ producao.data_registro.strftime('%d/%m/%Y %H:%M') }}<br>
            <strong><i class="fas fa-user"></i> Registrado por:</strong> {{ producao.usuario.nome }}<br>
            <strong><i class="fas fa-weight-hanging"></i> Quantidade:</strong> {{ producao.quantidade }} kg<br>
            <strong><i class="fas fa-calendar-alt"></i> Data Colheita:</strong> {{ producao.data_colheita.strftime('%d/%m/%Y') }}<br>
        </div>
        {% else %}
        <p>Nenhuma produção de mel registrada pela equipe.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}